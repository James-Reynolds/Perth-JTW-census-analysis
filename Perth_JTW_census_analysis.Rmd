---
title: "Perth COVID-19 study; journey to work census analysis"
runningheader: "Perth COVID-19 study; journey to work census analysis" # only for pdf output
subtitle: "Perth COVID-19 study; journey to work census analysis" # only for html output
author: "Dr James Reynolds, Monash University Public Transport Research Group (PTRG)"
date: "`r Sys.Date()`"
output:
  tufte::tufte_html: default
  tufte::tufte_handout:
    citation_package: natbib
    latex_engine: xelatex
  tufte::tufte_book:
    citation_package: natbib
    latex_engine: xelatex
bibliography: Perth_JTW_census_analysis.bib
link-citations: yes
---

```{r setup, include=FALSE}
library(tufte)
library(tidyverse)
library(sp)
library(ggplot2)
library(sf)
library(ASGS.foyer)
library(raster)
library(ggmap)
library(units)
library(absmapsdata)
library(readabs)
library(readr)
library(janitor)
library(scales)
library(ggstatsplot)
library(ggmap)
library(knitr)
library(abs)
library(readr)
library(prmisc)

# invalidate cache when the tufte version changes
knitr::opts_chunk$set(cache.extra = packageVersion('tufte'))
options(htmltools.dir.version = FALSE)
```

# 1.0 Introduction
Monash University's Public Transport Research Group (PTRG) is looking at changes in travel behaviour in Perth surrounding the COVID-19 pandemic. Part of this work involves examining the Australian Bureau of Statistics (ABS) journey-to-work data for the 2016 and 2021 censuses. Areas of interest are: 

- an aggregate analysis for all of the Greater Perth area;

- a disaggregate analysis for three groupings of Perth Local Government Areas (LGAs) defined in previous PTRG work as: the North-south grouping^[City of Melville, City of South Perth, City of Stirling, City of Joondalup, City of Wanneroo, City of Cockburn, City of Kwinana, City of Rockingham, City of Murray and City of Mandurah.], the Heritage grouping ^[City of Bayswater, City of Belmont, City of Canning, City of Fremantle, City of Nedlands, City of Perth, City of Subiaco, City of Vincent, Shire of Peppermint Grove, Town of Bassendean, Town of Cambridge, Town of Claremont, Town of Cottesloe, Town of East Fremantle, Town of Mosman Park, Town of Victoria Park and City of Gosnells.] and the Outer-east grouping^[City of Kalamunda, City of Swan, Shire of Mundaring, City of Armadale, and Shire of Serpentine-Jarrahdale.].

-	Perth CBD^[Here the Central Perth area is adatoped, as depicted in the WADoT Perth Greater CBD Transport Plan https://www.transport.wa.gov.au/mediaFiles/projects/PROJECT_I_Perth_Greater_CBD_Transport_Plan_map.pdf]  / non-CBD-based Jobs, for all of Greater Perth and for the North-south, Heritage and Outer-east groupings
  
This working note details the process of collecting and reviewing the ABS data. It is structured as follows: the next section details the processing of the ABS data; Section 3 presents the results; followed by a brief discussion in Section 4; and conclusions in Section 5. 

# 2.0 Methods and data

# 2.1 Journey to work by LGA (usual residence) and LGA (place of work)
Data tables for the 2016 and 2021 census were obtained for the journey to work mode by LGA of Usual Residence (UR)^[For LGAs within Western Australia only.] and LGA of Place Of Work (POW)^[For all LGAs in Australia.].  


```{r load_abs_2021_2016_destination_zones_correspondence_SA1_and_DZ, echo=FALSE, fig.margin=TRUE, fig.cap="Perth 2021 destination zonea", cache=TRUE}


####Next add the JTW data by DZ and LGA
## by Year and DZ and LGA data from ABS comes in a single file, with multiple CSV sections for each LGA. I found https://pypi.org/project/table_builder_io/ which deals with this issue over in python. 
##adapted from https://github.com/vlc/table_builder_io/ code in python
#from table_builder_io import TableBuilderReader
# Load python and pandas
#reader = TableBuilderReader.from_file("/Users/julianreynolds/Documents/work/Monash University/Greater_Perth_JTW_by_DZ_and_LGA_2021.csv")
#df = reader.read_table(as_index=True)
#df2 = reader.read(as_index=False)

##then from https://stackoverflow.com/a/55168518
#for i in df2: 
#   df2[i].to_csv('dataframe_id_'+str(i)+'.csv')
##All of this results in an output of everything in a separated CSV for each LGA. 
##Some stuffing around required as python does not play well with '0's and / etc in file names


#Load JTW by LGA (usual residence) and LGA (place of work)
list_csv_files <- list.files(path = "01 data/2016", full.names = TRUE)
LGA_UR_LGA_POW_JTW_2016 <- readr::read_csv(list_csv_files, id = "file_name")
list_csv_files <- list.files(path = "01 data/2021", full.names = TRUE)
LGA_UR_LGA_POW_JTW_2021 <- readr::read_csv(list_csv_files, id = "file_name")

#Extract LGA name from filename field
LGA_UR_LGA_POW_JTW_2016$lga_name_2016 <- sub(".*dataframe_id_","", LGA_UR_LGA_POW_JTW_2016$file_name)
LGA_UR_LGA_POW_JTW_2016$lga_name_2016 <- sub(".csv.*","", LGA_UR_LGA_POW_JTW_2016$lga_name_2016)
LGA_UR_LGA_POW_JTW_2021$lga_name_2021 <- sub(".*dataframe_id_","", LGA_UR_LGA_POW_JTW_2021$file_name)
LGA_UR_LGA_POW_JTW_2021$lga_name_2021 <- sub(".csv.*","", LGA_UR_LGA_POW_JTW_2021$lga_name_2021)

#clean names
LGA_UR_LGA_POW_JTW_2016 <- clean_names(LGA_UR_LGA_POW_JTW_2016)
LGA_UR_LGA_POW_JTW_2021 <- clean_names(LGA_UR_LGA_POW_JTW_2021)

#remove total rows
LGA_UR_LGA_POW_JTW_2016 <- LGA_UR_LGA_POW_JTW_2016 %>% filter(lga_pow  != "Total")
LGA_UR_LGA_POW_JTW_2021 <- LGA_UR_LGA_POW_JTW_2021 %>% filter(lga_pow  != "Total")

#remove unneeded column and set so that column names are consistent
##assume that 2021 LGAs are the same as 2016 LGAs
LGA_UR_LGA_POW_JTW_2016 <- tibble (lga_name_2021 = LGA_UR_LGA_POW_JTW_2016$lga_name_2016, LGA_UR_LGA_POW_JTW_2016[,3:19])
LGA_UR_LGA_POW_JTW_2021 <- tibble (lga_name_2021 = LGA_UR_LGA_POW_JTW_2021$lga_name_2021, LGA_UR_LGA_POW_JTW_2021[,3:19])

#Set 2021 column names to match 2016 column names
names(LGA_UR_LGA_POW_JTW_2021) <- c("lga_name_2021", "lga_pow", "train", "bus", "ferry", "tram", "taxi", "car_as_driver", "car_as_passenger", "truck", "motorbike_scooter", "bicycle", "other_mode",    "walked_only", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")    

```

Next, add the Heritage, North-south and Outer east groupings to the datasets. 
```{r add_groupings, echo=FALSE, fig.margin=TRUE, fig.cap="Perth 2021 destination zonea", cache=TRUE}
LGA_to_group <- tibble(lga_name_2021 = 
c("Melville", "South Perth", "Stirling", "Joondalup", "Wanneroo", "Cockburn", "Kwinana", "Rockingham", "Murray", "Mandurah",
  "Bayswater", "Belmont", "Canning","Fremantle", "Nedlands", "Perth", "Subiaco", "Vincent", "Peppermint Grove", "Bassendean", "Cambridge", "Claremont", "Cottesloe", "East Fremantle", "Mosman Park", "Victoria Park","Gosnells",
  "Kalamunda", "Swan", "Mundaring", "Armadale", "Serpentine-Jarrahdale", "Northam", "York"),
grouping = c("North-south", "North-south","North-south","North-south","North-south","North-south","North-south","North-south","North-south","North-south", "Heritage", "Heritage","Heritage","Heritage","Heritage","Heritage","Heritage","Heritage","Heritage","Heritage","Heritage","Heritage","Heritage","Heritage","Heritage","Heritage","Heritage", "Outer-east", "Outer-east","Outer-east","Outer-east","Outer-east", "Outer-east","Outer-east")
)

#join grouping to JTW data frames
LGA_UR_LGA_POW_JTW_2016 <- left_join(LGA_UR_LGA_POW_JTW_2016, LGA_to_group, by = "lga_name_2021")
LGA_UR_LGA_POW_JTW_2021 <- left_join(LGA_UR_LGA_POW_JTW_2021, LGA_to_group, by = "lga_name_2021")


#Define place of work destination groupings
LGA_UR_LGA_POW_JTW_2016$place_of_work <- with(LGA_UR_LGA_POW_JTW_2016, ifelse(LGA_UR_LGA_POW_JTW_2016$lga_pow == "Perth", 
                                                                              "CBD", 
                                                                              ifelse(LGA_UR_LGA_POW_JTW_2016$lga_pow %in% LGA_to_group$lga_name_2021, 
                                                                                     "Rest of Greater Perth", 
                                                                                     "Other")
                                                                              )
                                              )

 #Define place of work destination groupings
LGA_UR_LGA_POW_JTW_2021$place_of_work <- with(LGA_UR_LGA_POW_JTW_2021, ifelse(LGA_UR_LGA_POW_JTW_2021$lga_pow == "Perth", 
                                                                              "CBD", 
                                                                              ifelse(LGA_UR_LGA_POW_JTW_2021$lga_pow %in% LGA_to_group$lga_name_2021, 
                                                                                     "Rest of Greater Perth", 
                                                                                     "Other")
                                                                              )
                                              )


 
#drop non_Greater_Perth places of usual residence
LGA_UR_LGA_POW_JTW_2016 <- LGA_UR_LGA_POW_JTW_2016[!is.na(LGA_UR_LGA_POW_JTW_2016$grouping),]
LGA_UR_LGA_POW_JTW_2021 <- LGA_UR_LGA_POW_JTW_2021[!is.na(LGA_UR_LGA_POW_JTW_2021$grouping),]                      

```

# 2.2 Population and employment data

I have also downloaded the age and employment data for all of WA's LGAs so that it is possible to calculate population and employed population for each of the Heritage, North-south and Outer east groupings. 

```{r load_employment_and_age_data_SA1_and_DZ, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.cap="Greater Perth: Heritage, North-south and Outer East groupings", cache=TRUE}

library(readr)
X2016_WA_age_by_LGA <- read_csv("01 data/2016_WA_Age_by_LGA.csv", skip = 8)
X2016_WA_employment_by_LGA <- read_csv("01 data/2016_WA_employment_by_LGA.csv", skip=8)
X2021_WA_age_by_LGA <- read_csv("01 data/2021_WA_Age_by_LGA.csv", skip=8)
X2021_WA_employment_by_LGA <- read_csv("01 data/2021_WA_Employment_by_LGA.csv", skip=8)

#drop empty first row and last 5 rows, and last 2 columns
X2016_WA_age_by_LGA <- X2016_WA_age_by_LGA[2:(nrow(X2016_WA_age_by_LGA)-5), 1:(ncol(X2016_WA_age_by_LGA)-2)]
X2016_WA_employment_by_LGA <- X2016_WA_employment_by_LGA[2:(nrow(X2016_WA_employment_by_LGA)-5), 1:(ncol(X2016_WA_employment_by_LGA)-2)]
X2021_WA_age_by_LGA <- X2021_WA_age_by_LGA[2:(nrow(X2021_WA_age_by_LGA)-5), 1:(ncol(X2021_WA_age_by_LGA)-2)]
X2021_WA_employment_by_LGA <- X2021_WA_employment_by_LGA[2:(nrow(X2021_WA_employment_by_LGA)-5), 1:(ncol(X2021_WA_employment_by_LGA)-2)]

#set characters to numeric for column two
#Whoops, downloaded the by individual years data instead of the 10 year groupings
X2016_WA_age_by_LGA$`0 years` <- as.numeric(unlist(X2016_WA_age_by_LGA[,2]))
X2016_WA_employment_by_LGA$`Fully engaged`<- as.numeric(unlist(X2016_WA_employment_by_LGA[,2]))
X2021_WA_age_by_LGA$`0-9 years` <- as.numeric(unlist(X2021_WA_age_by_LGA[,2]))
X2021_WA_employment_by_LGA$`Fully engaged`<- as.numeric(unlist(X2021_WA_employment_by_LGA[,2]))

#set names the same
names(X2016_WA_age_by_LGA) <- 
  c("lga_name_2021", 
    names(X2016_WA_age_by_LGA[,2:ncol(X2016_WA_age_by_LGA)]))
names(X2016_WA_employment_by_LGA) <- 
  c("lga_name_2021", 
    names(X2016_WA_employment_by_LGA[,2:ncol(X2016_WA_employment_by_LGA)]))
names(X2021_WA_age_by_LGA) <- 
  c("lga_name_2021", 
    names(X2021_WA_age_by_LGA[,2:ncol(X2021_WA_age_by_LGA)]))
names(X2021_WA_employment_by_LGA) <- 
  c("lga_name_2021", 
    names(X2021_WA_employment_by_LGA[,2:ncol(X2021_WA_employment_by_LGA)]))


#Remove (C) and similar from lga names
X2016_WA_age_by_LGA$lga_name_2021 <- sub(" (*).*","", X2016_WA_age_by_LGA$lga_name_2021)
X2016_WA_employment_by_LGA$lga_name_2021 <- sub(" (*).*","", X2016_WA_employment_by_LGA$lga_name_2021)
X2021_WA_age_by_LGA$lga_name_2021 <- sub(" (*).*","", X2021_WA_age_by_LGA$lga_name_2021)
X2021_WA_employment_by_LGA$lga_name_2021 <- sub(" (*).*","", X2021_WA_employment_by_LGA$lga_name_2021)

#join grouping to employment and age data frames
X2016_WA_age_by_LGA <- left_join(X2016_WA_age_by_LGA, LGA_to_group, by = "lga_name_2021")
X2016_WA_employment_by_LGA <- left_join(X2016_WA_employment_by_LGA, LGA_to_group, by = "lga_name_2021")
X2021_WA_age_by_LGA <- left_join(X2021_WA_age_by_LGA, LGA_to_group, by = "lga_name_2021")
X2021_WA_employment_by_LGA <- left_join(X2021_WA_employment_by_LGA, LGA_to_group, by = "lga_name_2021")


```



# 3.0 Results

## 3.1 Aggregate for Greater Perth

The following shows aggregate results for all people whose usual residence in within Greater Perth. 

```{r Greater_Perth_JTW_aggregate, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r Transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].



# 3.2 Disaggregate
# 3.2.1 Heritage grouping

The following shows results for all people whose usual residence in within the Heritage grouping LGAs. 

```{r Heritage_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Heritage grouping, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(grouping == "Heritage") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(grouping == "Heritage") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r Heritage_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].



# 3.2.2 North-south grouping

The following shows results for all people whose usual residence in within the North-south grouping of LGAs. 

```{r North_South_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Heritage grouping, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(grouping == "North-south") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(grouping == "North-south") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r North_south_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].





# 3.2.3 Outer-east grouping
The following shows results for all people whose usual residence is within the Outer-east grouping of LGAs. 

```{r Outer_east_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Outer-east grouping, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(grouping == "Heritage") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(grouping == "Heritage") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r Outer_east_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].



# 3.3 Place of work - CBD

The following shows results for all people whose usual residence is within Greater Perth and whose place of work is within the (central) Perth LGA. 

```{r CBD_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Place of work in the (central) Perth LGA and usual residence in Greater Perth, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "CBD") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "CBD") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r CBD_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].






# 3.3.1 Heritage grouping


The following shows results for all people whose usual residence is within the Heritage grouping of LGAs and whose place of work is within the (central) Perth LGA. 

```{r Heritage_CBD_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Heritage grouping, CBD place of work, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "CBD") %>% filter(grouping == "Heritage") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "CBD") %>% filter(grouping == "Heritage") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r Heritage_CBD_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].



# 3.3.2 North-south grouping

The following shows results for all people whose usual residence is within the North-south grouping of LGAs and whose place of work is within the (central) Perth LGA. 

```{r North_south_CBD_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="North-south grouping, CBD place of work, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "CBD") %>% filter(grouping == "North-south") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "CBD") %>% filter(grouping == "North-south") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r North_south_CBD_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


# 3.3.3 Outer-east grouping

The following shows results for all people whose usual residence is within the Outer-east grouping of LGAs and whose place of work is within the (central) Perth LGA. 

```{r Outer_east_CBD_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="North-south grouping, CBD place of work, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "CBD") %>% filter(grouping == "Outer-east") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "CBD") %>% filter(grouping == "Outer-east") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r Outer_east_CBD_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


# 3.4 Place of work - rest of Greater Perth
The following shows results for all people whose usual residence is within Greater Perth and whose place of work is in Greater Perth but not within the (central) Perth LGA. 

```{r not_CBD_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Place of work in the rest of Greater Perth and usual residence in Greater Perth, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "Rest of Greater Perth") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "Rest of Greater Perth") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth and Place of Work in Greater Perth but not within the (central) Perth LGA, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth and Place of Work in Greater Perth but not within the (central) Perth LGA, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r not_CBD_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Usual residence in Greater Perth and Place of Work in Greater Perth but not within the (central) Perth LGA, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth and Place of Work in Greater Perth but not within the (central) Perth LGA, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].






# 3.4.1 Heritage grouping


The following shows results for all people whose usual residence is within the Heritage grouping of LGAs and whose place of work is in Greater Perth but not within the (central) Perth LGA. 

```{r Heritage_not_CBD_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Heritage grouping residents whose place of work is in Greater Perth but not within the (central) Perth LGA, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "Rest of Greater Perth") %>% filter(grouping == "Heritage") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "Rest of Greater Perth") %>% filter(grouping == "Heritage") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r Heritage_not_CBD_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].



# 3.4.2 North-south grouping

The following shows results for all people whose usual residence is within the North-south grouping of LGAs and whose place of work is in Greater Perth but not within the (central) Perth LGA. 

```{r North_south_not_CBD_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Residence in North-south grouping whose place of work is in Greater Perth but not within the (central) Perth LGA, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "Rest of Greater Perth") %>% filter(grouping == "North-south") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "Rest of Greater Perth") %>% filter(grouping == "North-south") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r North_south_not_CBD_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


# 3.4.3 Outer-east grouping

The following shows results for all people whose usual residence is within the Outer-east grouping of LGAs and whose place of work is in Greater Perth but not within the (central) Perth LGA.

```{r Outer_east_not_CBD_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="North-south grouping, whose place of work is in Greater Perth but not within the (central) Perth LGA, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "Rest of Greater Perth") %>% filter(grouping == "Outer-east") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "CBD") %>% filter(grouping == "Outer-east") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in outer-east grouping whose place of work is in Greater Perth but not within the (central) Perth LGA, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in the Outer-east grouping whose place of work is in Greater Perth but not within the (central) Perth LGA, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r Outer_east_not_CBD_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Outer-east grouping whose place of work is in Greater Perth but not within the (central) Perth LGA, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Outer-east whose place of work is in Greater Perth but not within the (central) Perth LGA, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

# 3.5 Place of work - not Greater Perth
The following shows results for all people whose usual residence is within Greater Perth and whose place of work is in Greater Perth but not within the (central) Perth LGA. 

```{r not_Perth_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Place of work not in Greater Perth and usual residence in Greater Perth, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "Other") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "Other") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth and place of work not in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Greater Perth and place of work not in Greater Perth , 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r not_Perth_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Usual residence in Greater Perth and Place of work not in Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Greater Perth and Place of work not in Greater Perth , 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].






# 3.5.1 Heritage grouping


The following shows results for all people whose usual residence is within the Heritage grouping of LGAs and whose place of work is in Greater Perth but not within the (central) Perth LGA. 

```{r Heritage_not_Perth_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Heritage grouping residents whose Place of work not in Greater Perth , journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "Other") %>% filter(grouping == "Heritage") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "Other") %>% filter(grouping == "Heritage") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in the Heritage grouping and Place of work not in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in the Heritage grouping and Place of work not in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r Heritage_not_Perth_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Heritage grouping and Place of work not in Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in the Heritage grouping and Place of work not in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].



# 3.5.2 North-south grouping

The following shows results for all people whose usual residence is within the North-south grouping of LGAs and whose place of work is not in Greater Perth. 

```{r North_south_not_Perth_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Residence in North-south grouping whose Place of work not in Greater Perth, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "Other") %>% filter(grouping == "North-south") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "Other") %>% filter(grouping == "North-south") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in the North-south grouping and place of work not in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in the North-south grouping and Place of work not in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r North_south_not_Perth_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="North-south grouping Place of work not in Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in the North-south grouping and Place of work not in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


# 3.4.3 Outer-east grouping

The following shows results for all people whose usual residence is within the Outer-east grouping of LGAs and whose place of work is not in Greater Perth.

```{r Outer_east_not_Perth_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Outer-east grouping, whose place of work is is not in Greater Perth, journey to work mode share, 2021 and 2016 censuses"}

#calculate aggregates for everyone with a usual residence in perth
Aggregate_JTW_2016_2021 <- tibble(LGA_UR_LGA_POW_JTW_2016 %>% filter(place_of_work == "Rest of Greater Perth") %>% filter(grouping == "Outer-east") %>% adorn_totals() %>% tail(n=1))
Aggregate_JTW_2016_2021 <- add_row(Aggregate_JTW_2016_2021, LGA_UR_LGA_POW_JTW_2021 %>% filter(place_of_work == "CBD") %>% filter(grouping == "Outer-east") %>% adorn_totals() %>% tail(n=1))

Aggregate_JTW_2016_2021$Year <- c("2016", "2021")

#combine modes to obtain PT, private vehicle (drive), private vehicle (passenger)  and non-motorised columns
Aggregate_JTW_2016_2021$private_vehicle_drive <- Aggregate_JTW_2016_2021$car_as_driver + Aggregate_JTW_2016_2021$truck + Aggregate_JTW_2016_2021$motorbike_scooter  

Aggregate_JTW_2016_2021$private_vehicle_passenger <- Aggregate_JTW_2016_2021$car_as_passenger + Aggregate_JTW_2016_2021$taxi  

Aggregate_JTW_2016_2021$transit <- Aggregate_JTW_2016_2021$train + Aggregate_JTW_2016_2021$bus + Aggregate_JTW_2016_2021$ferry + Aggregate_JTW_2016_2021$tram

Aggregate_JTW_2016_2021$non_motorised <- Aggregate_JTW_2016_2021$bicycle + Aggregate_JTW_2016_2021$walked_only

#Summarise all, including did not work, not stated and not applicable
kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home", "did_not_go_to_work", "not_stated", "not_applicable")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in Outer-east grouping whose place of work not in Greater Perth, 2016 and 2021 censuses"
)




#pivot_longer 
Aggregate_JTW_2016_2021_summary_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")], 
  cols = c("private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home"), 
  names_to = "Mode or activity",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_summary_longer$`Mode or activity` <- factor( Aggregate_JTW_2016_2021_summary_longer$`Mode or activity`, levels = c("work_at_home", "other_mode", "non_motorised", "transit", "private_vehicle_passenger", "private_vehicle_drive"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_summary_longer[,], 
  x = `Mode or activity`,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "private_vehicle_drive", "private_vehicle_passenger", "transit", "non_motorised", "other_mode", "worked_at_home")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode/activity shares, persons with a usual residence in the Outer-east grouping whose place of work is not in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```

A Pearson's chi-squared test indicated that the relationship between census and JTW activity/mode was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,c(14, 22:25)]))`.

The number of people who worked from home went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,15]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,15])-as.numeric(Aggregate_JTW_2016_2021[1,15]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,15])/as.numeric(Aggregate_JTW_2016_2021[1,15])-1)`)].  WFH share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,15]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,15]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was in a private vehicle that they drove  went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,22]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,22])-as.numeric(Aggregate_JTW_2016_2021[1,22]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,22])/as.numeric(Aggregate_JTW_2016_2021[1,22])-1)`)].  Driver mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,22]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,22]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW was as a passenger in a private vehicle went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,23]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,23])-as.numeric(Aggregate_JTW_2016_2021[1,23]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,23])/as.numeric(Aggregate_JTW_2016_2021[1,23])-1)`)].  Private vehicle as passenger mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,23]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,23]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


The number of people whose JTW used a non-motorised mode only (walk only or bike only) went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,25]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,25])-as.numeric(Aggregate_JTW_2016_2021[1,25]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,25])/as.numeric(Aggregate_JTW_2016_2021[1,25])-1)`)].  Non-motorised mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,25]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,25]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Transit ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,24]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,24])-as.numeric(Aggregate_JTW_2016_2021[1,24]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,24])/as.numeric(Aggregate_JTW_2016_2021[1,24])-1)`)].  Transit mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,24]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,24]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

The following summarizes the mode split amongst those who used transit: 


```{r Outer_east_not_Perth_transit_JTW, echo=FALSE, message=FALSE, warning=FALSE, fig.margin=FALSE, fig.fullwidth=FALSE, fig.cap="Outer-east grouping whose place of work is not in Greater Perth, journey to work mode share by train and bus, 2021 and 2016 censuses"}


#pivot_longer 
Aggregate_JTW_2016_2021_transit_longer <- pivot_longer(
  Aggregate_JTW_2016_2021[, c("Year", "train", "bus")], 
  cols = c("train", "bus"), 
  names_to = "Mode",
  values_to = "People"
)


#turn mode into a factor to get a specific order
Aggregate_JTW_2016_2021_transit_longer$Mode <- factor(Aggregate_JTW_2016_2021_transit_longer$Mode, levels = c("train", "bus", "ferry", "tram"))

p <- ggbarstats(
  Aggregate_JTW_2016_2021_transit_longer[,], 
  x = Mode,
  y = Year,
  counts = People
)

p

kable(untabyl(Aggregate_JTW_2016_2021[,c("Year", "train", "bus", "ferry", "tram")]) %>% adorn_totals(where = "col") %>% adorn_percentages() %>% adorn_pct_formatting() %>% adorn_ns(), caption = "Journey to work mode shares for transit, persons with a usual residence in Outer-east whose place of work is is not in Greater Perth, 2016 and 2021 censuses; excluding did not go to work, not stated and not applicable"
)

```


A Pearson's chi-squared test indicated that the relationship between census and the share of train-to-bus ridership was significant `r print_chi2(as.matrix(Aggregate_JTW_2016_2021[1:2,3:4]))`.


Train ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,3]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,3])-as.numeric(Aggregate_JTW_2016_2021[1,3]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,3])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Train mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,3]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,3]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].


Bus ridership went from `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[1,4]))` to `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4]))`^[Change of `r label_number(big.mark = ",")(as.numeric(Aggregate_JTW_2016_2021[2,4])-as.numeric(Aggregate_JTW_2016_2021[1,4]))`(`r label_percent()(as.numeric(Aggregate_JTW_2016_2021[2,4])/as.numeric(Aggregate_JTW_2016_2021[1,3])-1)`)].  Bus mode share changed from `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))` to `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])))`^[Change of `r label_percent(accuracy = 0.1)(as.numeric(Aggregate_JTW_2016_2021[2,4]/(Aggregate_JTW_2016_2021[2,22] + Aggregate_JTW_2016_2021[2,23] + Aggregate_JTW_2016_2021[2,24] + Aggregate_JTW_2016_2021[2,25] + Aggregate_JTW_2016_2021[2,14] + Aggregate_JTW_2016_2021[2,15])) - as.numeric(Aggregate_JTW_2016_2021[1,4]/(Aggregate_JTW_2016_2021[1,22] + Aggregate_JTW_2016_2021[1,23] + Aggregate_JTW_2016_2021[1,24] + Aggregate_JTW_2016_2021[1,25] + Aggregate_JTW_2016_2021[1,14] + Aggregate_JTW_2016_2021[1,15])))`.].

# 4.0 Discussion

# 5.0 Conclusions

#References




```{r bib, include=FALSE}
# create a bib file for the R packages used in this document
knitr::write_bib(c('base', 'rmarkdown'), file = 'skeleton.bib')
```


